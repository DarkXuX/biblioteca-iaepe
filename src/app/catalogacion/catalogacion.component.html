<div class="main-content">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-12">
        <div class="card">

          <div class="card-header card-header-primary card-header-icon  d-flex justify-content-between">
            <div class="w-100">
              <div class="card-icon">
                <i class="material-icons">add</i>
              </div>
              <h4 class="card-title">Catalogación</h4>
            </div>
            <div class="mt-2 d-flex">
              <!-- <button mat-raised-button mat-min-fab class="btn btn-primary btn-round btn-fab mr-2">
                <i class="material-icons material-icons pl-2 pt-1">download</i>
              </button>
              <button mat-raised-button mat-min-fab class="btn btn-primary btn-round btn-fab mr-2">
                <i class="material-icons material-icons pl-2 pt-1">favorite</i>
              </button> -->
            </div>
          </div>

          <div class="card-body">
            <div class="container">


              <!-- TIPOS DOCUMENTO -->
              <div class="row mt-3">
                <div class="col-md-2">
                  <h6 class="mt-3">Tipo de documento</h6>
                </div>
                <div class="col-md-10">
                  <div class="form-group">
                    <mat-form-field>
                      <mat-select placeholder="..." name="Docs" [(ngModel)]="docSelectInput"
                        (ngModelChange)="filterRules(docSelectInput)">
                        <mat-option *ngFor="let doc of typesDocs" [value]="doc.value">
                          {{ doc.viewValue }}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <!-- IMAGENES LIBRO -->
              <div class="row mt-3" *ngIf="docSelectInput">
                <div class="col-md-1">
                  <h6 class="mt-3">Portada</h6>
                </div>
                <div class="col-md-11">

                  <!-- book-cover-upload.component.html -->
                  <div class="container py-4">
                    <div class="row">
                      <!-- Portada -->
                      <div class="mb-4">
                        <div class="">
                          <div class="card-body">
                            <h5 class="card-title text-center">Portada</h5>

                            <div *ngIf="!covers.portada.previewUrl" class="upload-container"
                              (drop)="onDrop($event, 'portada')" (dragover)="onDragOver($event)"
                              (click)="openFileSelector('portada')">
                              <h6>Arrastra y suelta aquí</h6>
                              <p class="text-muted">o</p>
                              <button type="button" class="btn btn-primary btn-sm"
                                (click)="openFileSelector('portada'); $event.stopPropagation();">
                                Seleccionar
                              </button>
                              <input #portadaInput type="file" accept="image/*" class="d-none"
                                (change)="onFileSelected($event, 'portada')">
                              <p class="text-muted mt-3 mb-0 small">
                                Formatos: JPG, PNG, GIF (Máx. 5MB)
                              </p>
                            </div>

                            <div *ngIf="covers.portada.previewUrl" class="preview-container">
                              <div class="preview-wrapper">
                                <img [src]="covers.portada.previewUrl" class="preview-image" alt="Portada">
                                <button class="btn-remove" (click)="removeImage('portada')">
                                </button>
                              </div>
                              <div class="file-info">
                                <div class="d-flex justify-content-between">
                                  <span class="font-weight-bold">{{ covers.portada.file.name }}</span>
                                  <span class="text-muted">{{ formatFileSize(covers.portada.file.size) }}</span>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!-- Lomo -->
                      <div class="mb-4">
                        <div class="">
                          <div class="card-body">
                            <h5 class="card-title text-center">Lomo</h5>

                            <div *ngIf="!covers.lomo.previewUrl" class="upload-container"
                              (drop)="onDrop($event, 'lomo')" (dragover)="onDragOver($event)"
                              (click)="openFileSelector('lomo')">
                              <h6>Arrastra y suelta aquí</h6>
                              <p class="text-muted">o</p>
                              <button type="button" class="btn btn-primary btn-sm"
                                (click)="openFileSelector('lomo'); $event.stopPropagation();">
                                Seleccionar
                              </button>
                              <input #lomoInput type="file" accept="image/*" class="d-none"
                                (change)="onFileSelected($event, 'lomo')">
                              <p class="text-muted mt-3 mb-0 small">
                                Formatos: JPG, PNG, GIF (Máx. 5MB)
                              </p>
                            </div>

                            <div *ngIf="covers.lomo.previewUrl" class="preview-container">
                              <div class="preview-wrapper">
                                <img [src]="covers.lomo.previewUrl" class="preview-image" alt="Lomo">
                                <button class="btn-remove" (click)="removeImage('lomo')">
                                </button>
                              </div>
                              <div class="file-info">
                                <div class="d-flex justify-content-between">
                                  <span class="font-weight-bold">{{ covers.lomo.file.name }}</span>
                                  <span class="text-muted">{{ formatFileSize(covers.lomo.file.size) }}</span>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!-- Contraportada -->
                      <div class="mb-4">
                        <div class="">
                          <div class="card-body">
                            <h5 class="card-title text-center">Contraportada</h5>

                            <div *ngIf="!covers.contraportada.previewUrl" class="upload-container"
                              (drop)="onDrop($event, 'contraportada')" (dragover)="onDragOver($event)"
                              (click)="openFileSelector('contraportada')">
                              <h6>Arrastra y suelta aquí</h6>
                              <p class="text-muted">o</p>
                              <button type="button" class="btn btn-primary btn-sm"
                                (click)="openFileSelector('contraportada'); $event.stopPropagation();">
                                Seleccionar
                              </button>
                              <input #contraportadaInput type="file" accept="image/*" class="d-none"
                                (change)="onFileSelected($event, 'contraportada')">
                              <p class="text-muted mt-3 mb-0 small">
                                Formatos: JPG, PNG, GIF (Máx. 5MB)
                              </p>
                            </div>

                            <div *ngIf="covers.contraportada.previewUrl" class="preview-container">
                              <div class="preview-wrapper">
                                <img [src]="covers.contraportada.previewUrl" class="preview-image" alt="Contraportada">
                                <button class="btn-remove" (click)="removeImage('contraportada')">

                                </button>
                              </div>
                              <div class="file-info">
                                <div class="d-flex justify-content-between">
                                  <span class="font-weight-bold">{{ covers.contraportada.file.name }}</span>
                                  <span class="text-muted">{{ formatFileSize(covers.contraportada.file.size) }}</span>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="text-center mt-4">
                      <button class="btn btn-success" (click)="uploadImages()" [disabled]="!allImagesSelected()">
                        Subir imágenes
                      </button>
                    </div>
                  </div>
                </div>
              </div>


              <!-- RULES FILTRADAS DEL ELEMENTO SELECCIONADO -->
              <div class="row mt-3" *ngFor="let item of filteredRules">
                <div class="col-md-3">
                  <div class="d-flex align-items-center">
                    <span class="badge badge-secondary mt-1 mr-2" [matTooltip]="item.matTooltip"
                      [matTooltipPosition]="'above'" [ma]>{{ item.number }}</span>
                    <h6 class="mt-3">{{ item.label }}</h6>
                  </div>
                </div>
                <div class="col-md-9">
                  <ng-container *ngIf="item.tipo == 'Normal'">
                    <div class="form-group">
                      <input type="text" value="" placeholder="..." class="form-control" />
                    </div>
                  </ng-container>
                  <ng-container *ngIf="item.tipo == 'Button'">
                    <div class="d-flex justify-content-between">
                      <div class="form-group w-100">
                        <input type="text" value="" placeholder="..." class="form-control" />
                      </div>
                      <button mat-raised-button mat-min-fab class="btn btn-primary btn-round btn-fab ml-3">
                        <i class="material-icons material-icons">{{ item.iconButton }}</i>
                      </button>
                    </div>
                  </ng-container>
                  <ng-container *ngIf="item.tipo == 'List'">
                    <div class="form-group">
                      <mat-form-field>
                        <mat-select placeholder="..." name="city">
                          <mat-option *ngFor="let city of cities" [value]="city.value">
                            {{ city.viewValue }}
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </div>
                  </ng-container>
                </div>
              </div>


              <div class="w-100 text-center" *ngIf="!docSelectInput">
                <br>
                <br>
                <br>
                <br>
                <i class="material-icons">select_all</i>
                <h4> Selecciona un tipo de documento...</h4>
              </div>


              <br>
              <br>
              <br>
              <br>

              <div class="row justify-content-end">
                <button mat-raised-button class="btn btn-primary">Crear item</button>
              </div>


            </div>
          </div>
          <!-- end content-->
        </div>
        <!--  end card  -->
      </div>
      <!-- end col-md-12 -->
    </div>
    <!-- end row -->
  </div>
</div>